#!/bin/bash

# Input and output files
input=societies.data
output=societies.sql

# end of line comment
comment="--"

input_format_seg="\(.*\)"
input_format="^$input_format_seg@@$input_format_seg@@$input_format_seg$"

prefix="INSERT INTO \\\`entities\\\` \(\\\`entity_deleted\\\` \\)  VALUES \(\\'0\\'\);\\
INSERT INTO \\\`organisations\\\` \\(\\
  \\\`organisation_entity_id\\\` ,\\
  \\\`organisation_organisation_type_id\\\` ,\\
  \\\`organisation_name\\\` ,\\
  \\\`organisation_description\\\` ,\\
  \\\`organisation_url\\\` ,\\
  \\\`organisation_directory\\\` ,\\
  \\\`organisation_events\\\` ,\\
  \\\`organisation_hits\\\` \)\\
VALUES \\( LAST_INSERT_ID\\(\\), \\'2\\', \\'"
middle1="\\', \\'"
middle2="\\', \\\""
postfix="\\\" , \\'1\\', \\'1\\', \\'0\\' \\);\\
"

# header
echo "$comment Generated by process-societies" > $output
# parameters
echo "$comment Input: $input" >> $output
echo "$comment Output: $output" >> $output

echo "$comment Input: $input" >> $output
echo "$comment Output: $output" >> $output
echo "" >> $output

echo "$comment Uncomment below to replace all current records." >> $output
echo "$comment DELETE FROM \`entities\`;" >> $output
echo "$comment DELETE FROM \`organisations\`;" >> $output
echo "" >> $output

sed "s/$input_format/$prefix\1$middle1\2$middle2\3$postfix/" < $input >> $output
#echo "s/$input_format/$prefix\1$middle1\2$middle2\3$postfix/"