<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>Rapyd Components - User Guide</title>
<link rel="stylesheet" type="text/css" media="all" href="css/style.css" />
<link rel="stylesheet" type="text/css" href="css/syntax.css" />
<script type="text/javascript" src="js/nav.js"></script>
<script class="javascript" src="js/syntax.js"></script>
<script class="javascript" src="js/syntax_php.js"></script>
</head>
<body onload="dp.SyntaxHighlighter.HighlightAll('code');">

	<div id="content">
  
		<div class="line"></div>
  

<!-- begin header -->
<script type="text/javascript">header();</script>
<!-- end header -->



    <div class="left">

<!-- begin sidebar -->
<script type="text/javascript">sidebar();</script>
<!-- end sidebar -->



    </div>
    
    
		<div class="right">



  <div>

    <h2>DataForm</h2>
    <p>
      DataForm is a form helper and can be used to retrieve, update or insert new records directly without sql syntax.
      It is a <a href="themes.html">template</a> based component.<br/>
      Dataform is ancestor of <a href="datafilter.html">DataFilter</a> &amp; <a href="dataedit.html">DataEdit</a> 
		</p>

    <p>
    Note, this component is based upon <a href="fields.html">fields</a>.
    Fields are a collection of classes to manage single items of a form.
    </p>
    
  </div>
  
<div class="line"></div>
      
<h3>Sample:</h3>

  <textarea name="code" class="php:nogutter" rows="15" cols="100">
  
  $this->rapyd->load('dataform');

  $form = new DataForm("rapydsamples/dataform/process", null);

  $form->title = new inputField("Title", "title");
  $form->title->rule = "trim|required|max_length[20]";
  
  $form->body = new textareaField("Body", "body");
  $form->body->rule = "required";
  $form->body->rows = 10;    

  $form->checkbox = new checkboxField("Public", "public", "y","n");
  $form->submit("btnsubmit","SUBMIT");
  $form->build_form();

  if  ($form->on_show()) {
    $data["form_status"] = "Form displayed correctly";
  }

  if ($form->on_success()){
    $data["form_status"] = "Successful post";
  }
  
  if ($form->on_error()){
    $data["form_status"] = "There are errors";
  }

  $data["form"] = $form->output;


   </textarea>
      
<img src="img/dataform.gif" />

    
<div class="line"></div>

		<h3>constructor:</h3>
    <p>

		<var>DataForm($process_uri, $dataobject)</var><br/>
    params:<br/>
<ul>    
    <li>string $process_uri (can be null) is the uri that trig the process action.<br/>
    If it's used in a controller at this uri: "controller/method"..<br/>
    it must have one more segment (for example "controller/method/<strong>process</strong>").</li>
    <li>mixed $dataobject (can be null), a <a href="dataobject.html">DataObject</a> instance, or a string: the database "tablename"</li>
</ul>    
    for example you can use a DataForm as :<br/>
    
    </p>
    
  <textarea name="code" class="php:nogutter" rows="15" cols="100">

    //form helper
    $form = new DataForm("rapydsamples/dataform/process", null);
    ...
    
    //form that store new record  in the "articles" table;
    $form = new DataForm("rapydsamples/dataform/process", "articles");
    ...
    
    //form that preload record values and update current loaded record
    $record = new DataObject("articles");
    $record->load(1);
    
    $form = new DataForm("rapydsamples/dataform/process", $record); 

   </textarea>


    
<div class="line_under"></div>
    
    
    <a name="fields"> </a>
		<h3>DataForm &amp; Fields:</h3>
		<p>
In a DataForm you can append fields (inputs, extareas etc..) by declaring custom properties of DataForm instance and passing fields instances:<br/>

  <textarea name="code" class="php:nogutter" rows="2" cols="100">

    $form->title = new inputField("Title", "title");
 
   </textarea>
   
   
It is not important the property name, because it is just a pointer to the field.<br/>
The DataForm sniff all properties and autodetect fields.<br/>
</p>

<p>
<br />
Each field can have <strong>rules</strong> and <strong>callbacks</strong> (derived from CI Validation class):

  <textarea name="code" class="php:nogutter" rows="2" cols="100">

    $form->title->rule = "trim|required|max_length[20]"; 
 
   </textarea>

</p>

<p>
For Each field, you can change some main properties, and the <var>group</var> param can be used to group/separate fields in the DataForm layout:

  <textarea name="code" class="php:nogutter" rows="4" cols="100">

    $edit->description->cols = 70;
    $edit->description->rows = 4;
    $edit->description->group = "Contents";
 
   </textarea>
   
</p>

<p>
Field visibility can be limited to some DataForm status:
  <textarea name="code" class="php:nogutter" rows="4" cols="100">

    $iframe_uri = "admin/article_related/<#article_id#>/related/show";
    
    $edit->related = new iframeField("related", $iframe_uri, "210");
    $edit->related->when = array("show","modify");
 
   </textarea>
</p>

<div class="line_under"></div>
    <a name="methods"> </a>
		<h3>main methods:</h3>
		<p>
		<var>button($name, $caption, $action, $position="BL")</var><br/>
    append an html button.<br/>
    params:<br/>
     - string $name, button name&amp;id<br/>
     - string $caption, button caption<br/>
     - string $action, the onclick event action<br/>
     - string $position, position of button, can be: "TR" (tor-right), "BL" (bottom-left), "BR" (bottom-right)<br/>
     <br/>
     
		<var>submit($name, $caption, $position="BL")</var><br/>
    append an html submit button.<br/>
    params:<br/>
     - string $name, button name&amp;id<br/>
     - string $caption, button caption<br/>
     - string $position, position of button, can be: "TR" (tor-right), "BL" (bottom-left), "BR" (bottom-right)<br/>
     <br/>

		<var>script($script, $status="create")</var><br/>
    append javascript statement (simply a &lt;script&gt;$script&lt;/script&gt; code).<br/>
    params:<br/>
     - string $script, the javascript code<br/>
     - string $status, the code is added only when DataForm fields have this <a href="fields.html#status">status</a><br/>
     <br/>
         
         
		<var>on_show()</var><br/>
    return a boolean: if the DataForm status is "show" or not.<br/>
     <br/>
     
		<var>on_error()</var><br/>
    return a boolean: if the DataForm status is "error" (validation not passed) or not.<br/>
     <br/>

		<var>on_success()</var><br/>
    return a boolean: if the DataForm status is "success" (procedded and validation passed) or not.<br/>
     <br/>
      
		<var>build()</var><br/>
    build and eventually process the form.<br/>
		it do not prepare an html output but just run the build method on each field.<br/>
    then you can retrieve field output as: $form->field->output. and you can display and organize your custom form output.<br/>
     <br/>
    
		<var>build_form()</var><br/>
    like build() but it prepare/build a global html output.
    <br/>
		</p>
		
<div class="line_under"></div>

		<h3>output:</h3>
		<p>
		<var>output</var><br/>
    string, the built html form (only if you have excecuted the build_form() method before).
		</p>

		
	 </div>
		
</div>
    
<div class="line"></div>
    
<!-- begin footer -->
<script type="text/javascript">footer();</script>
<!-- end footer -->

    
	</div>

  
</body>
</html>